pipeline {
    agent any

   
   stages {
        stage('Check File') {
            steps {
                script {
                    if (fileExists('toto.txt')) {
                        echo 'Le fichier toto.txt est présent.'
                    } else {
                        error 'Le fichier toto.txt est introuvable.'
                    }
                }
            }
        }

        stage('Build and Test') {
            steps {
                echo 'Étape de build et de test...'

                // Installer les dépendances
                sh 'npm install'

                // Construire l'application
                sh 'npm run build'

                // Exécuter les tests
                sh 'npm test'
            }
        }

        stage('Demo') {
            steps {
                echo 'Bienvenue dans la démo de la pipeline!'
                echo 'Cette étape simule une démo de votre application.'
                echo 'Vous pourriez effectuer des actions spécifiques à votre projet ici.'
                echo 'Par exemple, afficher des informations, démarrer des serveurs de test, etc.'

                // Exemple : Démarrer un serveur HTTP local pour simuler le déploiement
                sh 'python -m http.server 8080 &'
            }
        }
    }

    post {
        success {
            echo 'Le pipeline a été exécuté avec succès!'
        }
        failure {
            echo 'Le pipeline a échoué. Veuillez vérifier les étapes précédentes.'
        }
    }
}
